# HAG: æ··åˆå¢å¼ºç”Ÿæˆæ¡†æ¶

<div align="center">

<img src="frontend/public/hag-logo-large.svg" alt="HAG Logo" width="350" />


[![GitHub stars](https://img.shields.io/github/stars/yankmo/HAG?style=social)](https://github.com/yankmo/HAG)
[![GitHub forks](https://img.shields.io/github/forks/yankmo/HAG?style=social)](https://github.com/yankmo/HAG)
[![GitHub issues](https://img.shields.io/github/issues/yankmo/HAG)](https://github.com/yankmo/HAG/issues)
[![GitHub license](https://img.shields.io/github/license/yankmo/HAG)](https://github.com/yankmo/HAG/blob/main/LICENSE)
[![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![LangChain](https://img.shields.io/badge/LangChain-0.1.0-green.svg)](https://langchain.com/)
[![Neo4j](https://img.shields.io/badge/Neo4j-5.0+-red.svg)](https://neo4j.com/)
[![Weaviate](https://img.shields.io/badge/Weaviate-1.20+-orange.svg)](https://weaviate.io/)

[English](README.md) | [ä¸­æ–‡](README_CN.md)

**ä½œè€…**: [YankMo](https://github.com/yankmo)

</div>

***

## ğŸš€ HAG æ˜¯ä»€ä¹ˆï¼Ÿ

HAGï¼ˆæ··åˆå¢å¼ºç”Ÿæˆï¼‰æ˜¯ä¸€ä¸ªå…ˆè¿›çš„çŸ¥è¯†å¢å¼ºç”Ÿæˆæ¡†æ¶ï¼Œç»“åˆäº†å‘é‡æ•°æ®åº“å’ŒçŸ¥è¯†å›¾è°±çš„å¼ºå¤§åŠŸèƒ½ï¼Œæä¾›æ™ºèƒ½é—®ç­”èƒ½åŠ›ã€‚åŸºäº LangChainã€Neo4j å’Œ Weaviate æ„å»ºï¼ŒHAG åœ¨é¢†åŸŸç‰¹å®šçŸ¥è¯†æ£€ç´¢å’Œæ¨ç†æ–¹é¢è¡¨ç°å“è¶Šã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ¯ æ™ºèƒ½æ„å›¾è¯†åˆ«

* **å¤šç»´åº¦ç†è§£**ï¼šæ·±åº¦è§£æç”¨æˆ·æŸ¥è¯¢æ„å›¾ï¼Œç²¾å‡†åŒ¹é…çŸ¥è¯†éœ€æ±‚

* **ä¸Šä¸‹æ–‡æ„ŸçŸ¥**ï¼šåŸºäºå¯¹è¯å†å²å’Œè¯­ä¹‰ç†è§£ï¼Œæä¾›ä¸ªæ€§åŒ–å“åº”

### ğŸ”„ åŒæ•°æ®åº“é›†æˆæ¶æ„

* **å‘é‡æ•°æ®åº“**ï¼šWeaviate æä¾›é«˜æ•ˆè¯­ä¹‰ç›¸ä¼¼æ€§æœç´¢

* **çŸ¥è¯†å›¾è°±**ï¼šNeo4j å®ç°å¤æ‚å…³ç³»æ¨ç†å’Œå®ä½“å‘ç°

* **æ··åˆæ£€ç´¢**ï¼šæ™ºèƒ½èåˆä¸¤ç§æ•°æ®æºï¼Œç¡®ä¿æ£€ç´¢å‡†ç¡®æ€§å’Œå®Œæ•´æ€§

### ğŸ“ æ–‡æ¡£å­˜å‚¨ç®¡ç†

* **æ–‡ä»¶ä¸Šä¼ **ï¼šæ”¯æŒå¤šç§æ–‡æ¡£æ ¼å¼ï¼ˆPDFã€TXTã€DOCXç­‰ï¼‰ï¼Œæä¾›æ‹–æ‹½ä¸Šä¼ ç•Œé¢

* **å¤„ç†æµæ°´çº¿**ï¼šå®æ—¶æ–‡æ¡£å¤„ç†ï¼Œæ”¯æŒè¿›åº¦è·Ÿè¸ªå’ŒçŠ¶æ€æ›´æ–°

* **å­˜å‚¨ç»Ÿè®¡**ï¼šå…¨é¢çš„Neo4jå®ä½“/å…³ç³»å’ŒWeaviateå‘é‡åˆ†æ

* **æ£€ç´¢æµ‹è¯•**ï¼šäº¤äº’å¼æœç´¢ç¤ºä¾‹ï¼Œæ”¯æŒåŒæ•°æ®åº“æŸ¥è¯¢åŠŸèƒ½

### ğŸš€ å…¨æ ˆWebåº”ç”¨

* **Reactå‰ç«¯**ï¼šç°ä»£åŒ–Reactç”¨æˆ·ç•Œé¢ï¼Œæ”¯æŒå“åº”å¼è®¾è®¡

* **FastAPIåç«¯**ï¼šé«˜æ€§èƒ½APIæœåŠ¡å™¨ï¼Œæä¾›å…¨é¢çš„æ¥å£è¦†ç›–

* **å®æ—¶æ›´æ–°**ï¼šå®æ—¶è¿›åº¦ç›‘æ§å’Œæ‰€æœ‰æ“ä½œçš„å³æ—¶åé¦ˆ

* **ä¼šè¯ç®¡ç†**ï¼šæŒä¹…åŒ–å¯¹è¯å†å²å’Œç”¨æˆ·ä¼šè¯å¤„ç†

### ğŸ¨ LINEARé£æ ¼è®¾è®¡

* **ç°ä»£åŒ–ç•Œé¢**ï¼šç®€æ´ä¼˜é›…çš„ç”¨æˆ·ä½“éªŒï¼Œéµå¾ªLINEARè®¾è®¡ç†å¿µ

* **æ·±è‰²ä¸»é¢˜**ï¼šä¸“ä¸šçš„æ·±è‰²æ¨¡å¼ç•Œé¢ï¼Œæ ·å¼ä¸€è‡´

* **ç›´è§‚å¯¼èˆª**ï¼šç®€åŒ–çš„ä¾§è¾¹æ å¯¼èˆªï¼ŒåŠŸèƒ½ç»„ç»‡æ¸…æ™°

## ç³»ç»Ÿæ¶æ„

![Workflow](./docs/images/black.svg)
*What is HAG*

## ğŸ“¸ æ•ˆæœå±•ç¤º

### 1. Web ç•Œé¢

![HAG Web Interface](./docs/images/Newapp.png)
*LINEARè®¾è®¡é£æ ¼å‰ç«¯ç•Œé¢*

### 2. æ£€ç´¢æ•ˆæœ

![HAG Retrieval Effect](./docs/images/NewSearch.png)
*æ··åˆæ£€ç´¢å·¥ä½œæµç¨‹å±•ç¤ºï¼Œèåˆå‘é‡æ•°æ®åº“å’ŒçŸ¥è¯†å›¾è°±*

### 3. æœ€ç»ˆå›ç­”

![HAG Final Answer](./docs/images/Newanswer.png)
*æ™ºèƒ½é—®ç­”ç»“æœå±•ç¤ºï¼ŒåŒ…å«å®Œæ•´çš„çŸ¥è¯†æ¥æºå’Œæ¨ç†è¿‡ç¨‹*

### 4. ä¼šè¯ç®¡ç†

![HAG Session Management](./docs/images/session.png)
*ä¼šè¯åŸºäºçš„å¯¹è¯ç®¡ç†ï¼Œæ”¯æŒæŒä¹…åŒ–å†å²è®°å½•*

### 5. å­˜å‚¨ç®¡ç†

![HAG Storage Management](./docs/images/storage.png)
*æ–‡æ¡£ä¸Šä¼ å’Œå¤„ç†æµæ°´çº¿å±•ç¤ºï¼ŒåŒ…æ‹¬è¿›åº¦ç›‘æ§å’ŒçŠ¶æ€æ›´æ–°*

### 6. æ£€ç´¢æµ‹è¯•

![HAG Retrieval Test](./docs/images/searchtemplate.png)
*äº¤äº’å¼æœç´¢ç¤ºä¾‹ï¼Œæ”¯æŒåŒæ•°æ®åº“æŸ¥è¯¢åŠŸèƒ½*

### 7. Neo4jç”Ÿæˆæ ·ä¾‹

![HAG Neo4j Example](./docs/images/neo4j.png)
*Neo4jçŸ¥è¯†å›¾è°±ç”Ÿæˆç¤ºä¾‹ï¼Œå±•ç¤ºå®ä½“å…³ç³»å’Œæ¨ç†è·¯å¾„*

## ğŸ“¦ å®‰è£…

### å‰ç½®è¦æ±‚

* Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬

* Node.js 16+ å’Œ npm

* Docker å’Œ Docker Compose

* Git

### å¿«é€Ÿå¼€å§‹

1. **å…‹éš†ä»“åº“**

```bash
git clone https://github.com/yankmo/HAG.git
cd HAG
```

1. **å®‰è£…åç«¯ä¾èµ–**

```bash
pip install -r requirements.txt
```

1. **å®‰è£…å‰ç«¯ä¾èµ–**

```bash
cd frontend
npm install
cd ..
```

1. **å¯åŠ¨å¿…éœ€æœåŠ¡**

```bash
# å¯åŠ¨ Neo4j
docker run -d --name neo4j \
  -p 7474:7474 -p 7687:7687 \
  -e NEO4J_AUTH=neo4j/your_password \
  neo4j:latest

# å¯åŠ¨ Weaviate
docker run -d --name weaviate \
  -p 8080:8080 \
  -e QUERY_DEFAULTS_LIMIT=25 \
  -e AUTHENTICATION_ANONYMOUS_ACCESS_ENABLED=true \
  semitechnologies/weaviate:latest

# å¯åŠ¨ Ollama
docker run -d --name ollama \
  -p 11434:11434 \
  ollama/ollama:latest
```

1. **é…ç½®ç³»ç»Ÿ**

```bash
# ç¼–è¾‘é…ç½®æ–‡ä»¶
cp config/config.yaml.example config/config.yaml
# æ›´æ–°æ•°æ®åº“å‡­æ®å’ŒæœåŠ¡ URL
```

1. **å¯åŠ¨åº”ç”¨ç¨‹åº**

```bash
# ç»ˆç«¯1ï¼šå¯åŠ¨åç«¯APIæœåŠ¡å™¨
python backend_api.py

# ç»ˆç«¯2ï¼šå¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨
cd frontend
npm start
```

1. **è®¿é—®åº”ç”¨ç¨‹åº**

* å‰ç«¯ç•Œé¢ï¼š<http://localhost:3000>

* åç«¯APIï¼š<http://localhost:8000>

* APIæ–‡æ¡£ï¼š<http://localhost:8000/docs>

## ğŸ”§ é…ç½®

ç¼–è¾‘ `config/config.yaml` æ¥è‡ªå®šä¹‰æ‚¨çš„è®¾ç½®ï¼š

```yaml
# Neo4j é…ç½®
neo4j:
  uri: "bolt://localhost:7687"
  username: "neo4j"
  password: "your_password"

# Ollama é…ç½®
ollama:
  base_url: "http://localhost:11434"
  default_model: "gemma3:4b"
  embedding_model: "bge-m3:latest"

# Weaviate é…ç½®
weaviate:
  url: "http://localhost:8080"
```

## ğŸ§ª ä½¿ç”¨ç¤ºä¾‹

### Web ç•Œé¢

å¯åŠ¨å‰åç«¯æœåŠ¡å™¨åï¼Œè®¿é—® `http://localhost:3000` ä½¿ç”¨å®Œæ•´åŠŸèƒ½çš„Webåº”ç”¨ç¨‹åºã€‚

**ä¸»è¦åŠŸèƒ½ï¼š**

* **å¯¹è¯ç•Œé¢**ï¼šæé—®å¹¶è·å¾—æ™ºèƒ½å›ç­”

* **æ–‡æ¡£ä¸Šä¼ **ï¼šä¸Šä¼ å’Œå¤„ç†æ–‡æ¡£ä»¥æ‰©å±•çŸ¥è¯†åº“

* **å­˜å‚¨ç®¡ç†**ï¼šç›‘æ§å¤„ç†è¿›åº¦å’ŒæŸ¥çœ‹å­˜å‚¨ç»Ÿè®¡

* **æ£€ç´¢æµ‹è¯•**ï¼šæµ‹è¯•Neo4jå’ŒWeaviateæ•°æ®åº“çš„æœç´¢åŠŸèƒ½

### API ä½¿ç”¨

```python
import requests

# æŸ¥è¯¢HAGç³»ç»Ÿ
response = requests.post("http://localhost:8000/query", json={
    "query": "å¸•é‡‘æ£®ç—…çš„ç—‡çŠ¶æ˜¯ä»€ä¹ˆï¼Ÿ",
    "session_id": "user_session_123"
})
result = response.json()
print(result["response"])

# ä¸Šä¼ æ–‡æ¡£
with open("document.pdf", "rb") as f:
    files = {"file": f}
    response = requests.post("http://localhost:8000/storage/upload", files=files)
    upload_result = response.json()
    print(f"ä»»åŠ¡ID: {upload_result['task_id']}")

# æ£€æŸ¥å¤„ç†è¿›åº¦
task_id = upload_result["task_id"]
response = requests.get(f"http://localhost:8000/storage/progress/{task_id}")
progress = response.json()
print(f"è¿›åº¦: {progress['progress']}%")
```

### ç›´æ¥æœåŠ¡è®¿é—®

```python
from api import HAGIntegratedAPI

# åˆå§‹åŒ–ç³»ç»Ÿ
hag = HAGIntegratedAPI()

# æé—®
response = hag.runnable_chain.invoke("å¸•é‡‘æ£®ç—…çš„ç—‡çŠ¶æ˜¯ä»€ä¹ˆï¼Ÿ")
print(response)

# ç›´æ¥ä½¿ç”¨æ··åˆæ£€ç´¢
from src.services import HybridRetrievalService
hybrid_service = HybridRetrievalService(...)
results = hybrid_service.search("åŒ»ç–—æŸ¥è¯¢", limit=5)
```

### å­˜å‚¨ç®¡ç†

```python
# è·å–å­˜å‚¨ç»Ÿè®¡
response = requests.get("http://localhost:8000/storage/stats")
stats = response.json()
print(f"æ€»æ–‡æ¡£æ•°: {stats['total_documents']}")
print(f"Neo4jå®ä½“æ•°: {stats['neo4j_stats']['entities']}")
print(f"Weaviateå‘é‡æ•°: {stats['weaviate_stats']['vectors']}")

# æµ‹è¯•æ£€ç´¢åŠŸèƒ½
response = requests.post("http://localhost:8000/storage/search/test", json={
    "query": "äººå·¥æ™ºèƒ½",
    "search_type": "both"  # é€‰é¡¹: "neo4j", "weaviate", "both"
})
search_results = response.json()
print("Neo4jç»“æœ:", search_results["neo4j_results"])
print("Weaviateç»“æœ:", search_results["weaviate_results"])
```

## ğŸ§ª æµ‹è¯•

è¿è¡Œæµ‹è¯•å¥—ä»¶ä»¥éªŒè¯æ‚¨çš„å®‰è£…ï¼š

```bash
# æµ‹è¯•åŸºæœ¬åŠŸèƒ½
python -c "from api import HAGIntegratedAPI; api = HAGIntegratedAPI(); print('âœ… HAG åˆå§‹åŒ–æˆåŠŸ')"
```

## ğŸ¤ è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿è´¡çŒ®ï¼è¯·æŸ¥çœ‹æˆ‘ä»¬çš„[è´¡çŒ®æŒ‡å—](CONTRIBUTING.md)äº†è§£è¯¦æƒ…ã€‚

1. Fork ä»“åº“
2. åˆ›å»ºæ‚¨çš„åŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ‚¨çš„æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ‘¨â€ğŸ’» ä½œè€…

**YankMo**

* GitHub: [@yankmo](https://github.com/yankmo)

* CSDN åšå®¢: [YankMo çš„æŠ€æœ¯åšå®¢](https://blog.csdn.net/YankMo)

***

<div align="center">

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª Starï¼**

</div>
