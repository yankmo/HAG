# HAG é¡¹ç›®é…ç½®è¿ç§»å®ŒæˆæŠ¥å‘Š

## ğŸ“‹ è¿ç§»æ¦‚è¿°

HAG é¡¹ç›®çš„é…ç½®ç³»ç»Ÿé‡æ„å·²å…¨é¢å®Œæˆï¼æ‰€æœ‰ç¡¬ç¼–ç çš„é…ç½®å·²æˆåŠŸè¿ç§»åˆ°ç»Ÿä¸€çš„é…ç½®ç®¡ç†ç³»ç»Ÿä¸­ï¼Œæé«˜äº†é¡¹ç›®çš„å¯ç»´æŠ¤æ€§ã€å¯é…ç½®æ€§å’Œéƒ¨ç½²çµæ´»æ€§ã€‚

## âœ… å·²å®Œæˆçš„è¿ç§»

### ğŸ—ï¸ é…ç½®ç³»ç»Ÿæ¶æ„

#### 1. æ ¸å¿ƒé…ç½®æ¨¡å—
- **`config/__init__.py`** - é…ç½®æ¨¡å—å…¥å£ï¼Œæä¾› `get_config()` å’Œ `reload_config()` å‡½æ•°
- **`config/settings.py`** - é…ç½®ç±»å®šä¹‰å’Œé…ç½®ç®¡ç†å™¨ï¼Œæ”¯æŒå¤šç§é…ç½®æº
- **`config/config.yaml`** - é»˜è®¤é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰æœåŠ¡çš„é…ç½®

#### 2. é…ç½®æ”¯æŒç‰¹æ€§
- âœ… **å¤šé…ç½®æºæ”¯æŒ**: YAMLã€JSONã€ç¯å¢ƒå˜é‡
- âœ… **é…ç½®ä¼˜å…ˆçº§**: ç¯å¢ƒå˜é‡ > JSON > YAML > é»˜è®¤å€¼
- âœ… **ç±»å‹å®‰å…¨**: ä½¿ç”¨ Pydantic è¿›è¡Œé…ç½®éªŒè¯
- âœ… **çƒ­é‡è½½**: æ”¯æŒè¿è¡Œæ—¶é‡æ–°åŠ è½½é…ç½®
- âœ… **ä¾¿æ·æ–¹æ³•**: æä¾›æœåŠ¡çŠ¶æ€æ£€æŸ¥ URL ç”Ÿæˆ

### ğŸ“ å·²è¿ç§»çš„æ–‡ä»¶

#### æ ¸å¿ƒæ¨¡å— (8ä¸ªæ–‡ä»¶)
1. **`src/knowledge/modular_rag_system.py`** âœ…
   - Neo4j è¿æ¥é…ç½® (URI, ç”¨æˆ·å, å¯†ç )
   
2. **`src/knowledge/vector_storage.py`** âœ…
   - Ollama åµŒå…¥æ¨¡å‹é…ç½® (base_url, model)
   - Weaviate å‘é‡å­˜å‚¨é…ç½® (url, host, port)
   
3. **`src/knowledge/intent_recognition_neo4j.py`** âœ…
   - Ollama å®¢æˆ·ç«¯é…ç½® (base_url, model)
   - Neo4j å¯¼å…¥å™¨é…ç½® (URI, è®¤è¯)
   
4. **`src/core/rag.py`** âœ…
   - Ollama å®¢æˆ·ç«¯é…ç½® (host, timeout)
   - åµŒå…¥æ¨¡å‹é…ç½®
   
5. **`src/knowledge/hybrid_vector_graph_system.py`** âœ…
   - Neo4j å›¾æ•°æ®åº“é…ç½®
   - Ollama åµŒå…¥å®¢æˆ·ç«¯é…ç½®
   - Weaviate å‘é‡å­˜å‚¨é…ç½®

#### åº”ç”¨ç¨‹åº (3ä¸ªæ–‡ä»¶)
6. **`app_simple.py`** âœ…
   - SimpleOllamaLLM é…ç½® (model, base_url)
   - SimpleRAGSystem Neo4j é…ç½®
   - OllamaEmbeddingClient æ¨¡å‹é…ç½®
   
7. **`main.py`** âœ…
   - OllamaLLM é…ç½® (model_name, base_url)
   
8. **`app.py`** âœ…
   - OllamaLLM é…ç½® (model, base_url)

#### è„šæœ¬æ–‡ä»¶ (2ä¸ªæ–‡ä»¶)
9. **`scripts/clear_neo4j.py`** âœ…
   - Neo4j æ•°æ®åº“æ¸…ç†è„šæœ¬é…ç½®
   
10. **`scripts/query_neo4j.py`** âœ…
    - Neo4j æŸ¥è¯¢è„šæœ¬é…ç½®

#### æµ‹è¯•æ–‡ä»¶ (4ä¸ªæ–‡ä»¶)
11. **`test/neo4j.py`** âœ…
    - Neo4j æµ‹è¯•è¿æ¥é…ç½®
    
12. **`test/test_ollama.py`** âœ…
    - Ollama API æµ‹è¯•é…ç½®
    - å®¢æˆ·ç«¯è¶…æ—¶é…ç½®
    
13. **`test/weaviatelink.py`** âœ…
    - Weaviate å®¢æˆ·ç«¯é…ç½®

### ğŸ› ï¸ æ–°å¢çš„å·¥å…·å’Œæ–‡æ¡£

#### é…ç½®ç®¡ç†å·¥å…·
1. **`.env.example`** - ç¯å¢ƒå˜é‡é…ç½®ç¤ºä¾‹æ–‡ä»¶
2. **`init_config.py`** - é…ç½®åˆå§‹åŒ–è„šæœ¬ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿè®¾ç½®
3. **`validate_config.py`** - é…ç½®éªŒè¯è„šæœ¬ï¼Œæ£€æŸ¥æœåŠ¡è¿æ¥çŠ¶æ€

#### æ–‡æ¡£å’ŒæŒ‡å—
4. **`docs/é…ç½®è¿ç§»æŒ‡å—.md`** - è¯¦ç»†çš„é…ç½®ä½¿ç”¨æŒ‡å—
5. **`README.md`** - æ›´æ–°äº†é…ç½®ç³»ç»Ÿè¯´æ˜
6. **æœ¬æŠ¥å‘Š** - è¿ç§»å®Œæˆæ€»ç»“

## ğŸ”§ é…ç½®ä½¿ç”¨æ–¹å¼

### 1. é…ç½®æ–‡ä»¶æ–¹å¼ (æ¨è)
```yaml
# config/config.yaml
neo4j:
  uri: "bolt://localhost:7687"
  username: "neo4j"
  password: "your_password"

ollama:
  base_url: "http://localhost:11434"
  default_model: "gemma3:4b"
  embedding_model: "bge-m3:latest"

weaviate:
  url: "http://localhost:8080"
  host: "localhost"
  port: 8080
```

### 2. ç¯å¢ƒå˜é‡æ–¹å¼
```bash
# .env æ–‡ä»¶
NEO4J_URI=bolt://localhost:7687
NEO4J_USERNAME=neo4j
NEO4J_PASSWORD=your_password
OLLAMA_BASE_URL=http://localhost:11434
WEAVIATE_URL=http://localhost:8080
```

### 3. ä»£ç ä¸­ä½¿ç”¨
```python
from config import get_config

config = get_config()

# ä½¿ç”¨ Neo4j é…ç½®
graph = Graph(config.neo4j.uri, auth=config.neo4j.to_auth_tuple())

# ä½¿ç”¨ Ollama é…ç½®
llm = OllamaLLM(
    model=config.ollama.default_model,
    base_url=config.ollama.base_url
)

# ä½¿ç”¨ Weaviate é…ç½®
vector_store = WeaviateVectorStore()  # è‡ªåŠ¨ä½¿ç”¨é…ç½®
```

## ğŸ“Š è¿ç§»ç»Ÿè®¡

| ç±»åˆ« | æ–‡ä»¶æ•°é‡ | é…ç½®é¡¹æ•°é‡ | çŠ¶æ€ |
|------|----------|------------|------|
| æ ¸å¿ƒæ¨¡å— | 5 | 15+ | âœ… å®Œæˆ |
| åº”ç”¨ç¨‹åº | 3 | 8+ | âœ… å®Œæˆ |
| è„šæœ¬æ–‡ä»¶ | 2 | 6+ | âœ… å®Œæˆ |
| æµ‹è¯•æ–‡ä»¶ | 4 | 10+ | âœ… å®Œæˆ |
| **æ€»è®¡** | **14** | **39+** | **âœ… å®Œæˆ** |

## ğŸ¯ è¿ç§»æ•ˆæœ

### è¿ç§»å‰ (ç¡¬ç¼–ç )
```python
# ç¡¬ç¼–ç ï¼Œéš¾ä»¥ç»´æŠ¤
graph = Graph('bolt://localhost:7687', auth=('neo4j', 'hrx274700'))
ollama_client = ollama.Client(host='http://localhost:11434')
vector_store = WeaviateVectorStore(url='http://localhost:8080')
```

### è¿ç§»å (é…ç½®åŒ–)
```python
# é…ç½®åŒ–ï¼Œçµæ´»å¯ç»´æŠ¤
from config import get_config

config = get_config()
graph = Graph(config.neo4j.uri, auth=config.neo4j.to_auth_tuple())
ollama_client = ollama.Client(host=config.ollama.base_url)
vector_store = WeaviateVectorStore()  # è‡ªåŠ¨ä½¿ç”¨é…ç½®
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åˆå§‹åŒ–é…ç½®
```bash
python init_config.py
```

### 2. ç¼–è¾‘é…ç½®æ–‡ä»¶
ç¼–è¾‘ `config/config.yaml` æˆ– `.env` æ–‡ä»¶ï¼Œè®¾ç½®å®é™…çš„æœåŠ¡é…ç½®ã€‚

### 3. éªŒè¯é…ç½®
```bash
python validate_config.py
```

### 4. å¯åŠ¨åº”ç”¨
```bash
streamlit run app_simple.py
```

## ğŸ” é…ç½®éªŒè¯

ä½¿ç”¨é…ç½®éªŒè¯è„šæœ¬æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€ï¼š

```bash
$ python validate_config.py

ğŸ” HAG é¡¹ç›®é…ç½®éªŒè¯
==================================================
âœ… é…ç½®æ–‡ä»¶åŠ è½½æˆåŠŸ

ğŸ“‹ é…ç½®æ‘˜è¦:
  Neo4j URI: bolt://localhost:7687
  Neo4j ç”¨æˆ·: neo4j
  Neo4j æ•°æ®åº“: neo4j
  Ollama URL: http://localhost:11434
  Ollama é»˜è®¤æ¨¡å‹: gemma3:4b
  Ollama åµŒå…¥æ¨¡å‹: bge-m3:latest
  Weaviate URL: http://localhost:8080

ğŸ”§ æœåŠ¡è¿æ¥æµ‹è¯•:
  æ£€æŸ¥ Neo4j... âœ… è¿æ¥æˆåŠŸ
  æ£€æŸ¥ Ollama... âœ… æœåŠ¡æ­£å¸¸ï¼Œå·²å®‰è£…æ¨¡å‹: 5 ä¸ª
  æ£€æŸ¥ Weaviate... âœ… æœåŠ¡æ­£å¸¸ï¼Œç‰ˆæœ¬: 1.22.4

ğŸŒ æœåŠ¡è®¿é—®åœ°å€:
  Neo4j Browser: http://localhost:7474
  Ollama API: http://localhost:11434/api/tags
  Weaviate: http://localhost:8080

==================================================
ğŸ‰ æ‰€æœ‰æœåŠ¡é…ç½®æ­£ç¡®ï¼Œå¯ä»¥å¯åŠ¨åº”ç”¨ï¼

å¯åŠ¨å‘½ä»¤:
  streamlit run app_simple.py
```

## ğŸ’¡ æœ€ä½³å®è·µ

1. **å®‰å…¨æ€§**: ä¸è¦å°†åŒ…å«çœŸå®å¯†ç çš„é…ç½®æ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
2. **ç¯å¢ƒéš”ç¦»**: ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒçš„é…ç½®æ–‡ä»¶
3. **é…ç½®å¤‡ä»½**: é‡è¦é…ç½®æ–‡ä»¶åº”è¯¥å¤‡ä»½
4. **æƒé™æ§åˆ¶**: é…ç½®æ–‡ä»¶åº”è¯¥è®¾ç½®é€‚å½“çš„æ–‡ä»¶æƒé™

## ğŸ‰ æ€»ç»“

HAG é¡¹ç›®çš„é…ç½®ç³»ç»Ÿé‡æ„å·²å…¨é¢å®Œæˆï¼Œå®ç°äº†ï¼š

- âœ… **ç»Ÿä¸€é…ç½®ç®¡ç†**: æ‰€æœ‰é…ç½®é›†ä¸­ç®¡ç†ï¼Œæ˜“äºç»´æŠ¤
- âœ… **å¤šç¯å¢ƒæ”¯æŒ**: æ”¯æŒå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç­‰ä¸åŒç¯å¢ƒ
- âœ… **ç±»å‹å®‰å…¨**: é…ç½®éªŒè¯ç¡®ä¿ç±»å‹æ­£ç¡®æ€§
- âœ… **çµæ´»éƒ¨ç½²**: æ”¯æŒå¤šç§é…ç½®æ–¹å¼ï¼Œé€‚åº”ä¸åŒéƒ¨ç½²åœºæ™¯
- âœ… **å¼€å‘å‹å¥½**: æä¾›å®Œæ•´çš„å·¥å…·é“¾å’Œæ–‡æ¡£æ”¯æŒ

é¡¹ç›®ç°åœ¨å…·å¤‡äº†ä¼ä¸šçº§çš„é…ç½®ç®¡ç†èƒ½åŠ›ï¼Œä¸ºåç»­çš„åŠŸèƒ½æ‰©å±•å’Œéƒ¨ç½²æä¾›äº†åšå®çš„åŸºç¡€ï¼